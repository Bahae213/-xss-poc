<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>üî• WebView XSS PoC</title>
  <style>
    body {
      background: #f5f5f5;
      color: #333;
      font-family: Consolas, monospace;
      padding: 1rem;
      max-width: 800px;
      margin: 0 auto;
    }
    .disclaimer {
      background: #fff8e1;
      border-left: 4px solid #ffc107;
      padding: 1rem;
      margin-bottom: 1rem;
    }
    iframe {
      width: 100%;
      height: 300px;
      border: 1px solid #ccc;
      margin-top: 1rem;
    }
    button {
      background: #e53935;
      color: white;
      font-weight: bold;
      padding: 0.5rem 1rem;
      border: none;
      cursor: pointer;
      border-radius: 4px;
    }
    #log {
      background: #fff;
      border: 1px solid #ccc;
      padding: 1rem;
      margin-top: 1rem;
      white-space: pre-wrap;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>

<div class="disclaimer">
  <h3>‚ö†Ô∏è Security Demonstration</h3>
  <p>This is a simulated vulnerable WebView. It demonstrates what happens when untrusted HTML is injected directly into the DOM.</p>
</div>

<h2>üî• Arc WebView XSS PoC</h2>
<p>Click the button below to send a <strong>malicious payload</strong> to the simulated WebView:</p>
<button onclick="sendXSS()">üí• Send XSS Payload</button>

<iframe id="webview" srcdoc="
  <!DOCTYPE html>
  <html>
  <body style='font-family: Arial; padding: 1rem; background: #fffbe6;'>
    <h3>üß™ Vulnerable WebView</h3>
    <div id='output'>[waiting for message]</div>
    <script>
      window.addEventListener('message', (e) => {
        const output = document.getElementById('output');
        if (e.data?.dangerousHTML) {
          output.innerHTML = e.data.dangerousHTML;
        } else {
          output.textContent = '[Invalid or safe message]';
        }
      });
    </script>
  </body>
  </html>
"></iframe>

<div id="log">[log will appear here]</div>

<script>
function sendXSS() {
  const payload = {
    dangerousHTML: `<script>alert('üî• XSS confirmed')</script>`
  };
  const frame = document.getElementById('webview');
  frame.contentWindow.postMessage(payload, '*');
  document.getElementById('log').textContent =
    'üì§ XSS Payload sent:\n' +
    JSON.stringify(payload, null, 2);
}
</script>

</body>
</html>
