<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>‚ö†Ô∏è Security Research: XSS Vectors Demo</title>
  <style>
    body { background: #111; color: #0f0; font-family: monospace; padding: 1rem; max-width: 900px; margin: 0 auto; }
    .warning { color: #ff0; border-left: 3px solid #ff0; padding-left: 1rem; }
  </style>
</head>
<body>

<div class="warning">
  <h3>‚ö†Ô∏è Important Notice:</h3>
  <p>This is for educational purposes only. Unauthorized testing on live systems is illegal.</p>
</div>

<h2>üîç Multi-Vector DOM XSS Demonstration</h2>
<p>This demo illustrates various XSS vectors for security research purposes.</p>

<iframe id="target" src="about:blank" width="100%" height="600" style="border: 2px solid lime;"></iframe>

<script>
const iframe = document.getElementById("target");
iframe.src = "https://thebrowser.company/"; // Load after DOM ready

// Safe demonstration payloads (non-malicious)
const payloads = [
  // Example 1: Basic injection test
  {
    message: "SECURITY_DEMO",
    content: {
      test: "This would be a potential XSS vector in vulnerable systems"
    }
  },

  // Example 2: React props simulation
  {
    props: {
      __html: "<!-- Simulated unsafe content -->"
    }
  },

  // Example 3: SVG context
  {
    type: "security_demo",
    html: "<!-- Simulated SVG payload -->"
  }
];

// Mock encoder for demonstration
function mockEncode(str) {
  return "ENCODED_" + btoa(encodeURIComponent(str)).substring(0, 32);
}

// Safe demonstration function
function demonstrateVectors() {
  console.log("üîß Starting security demonstration");

  // 1. Safe window.name example
  try {
    iframe.contentWindow.name = JSON.stringify({ 
      demo: "This demonstrates how window.name could be used" 
    });
    console.log("‚ÑπÔ∏è window.name demonstration set");
  } catch (e) {
    console.warn("‚ö†Ô∏è Security restriction encountered:", e);
  }

  // 2. Simulated encoded message
  setTimeout(() => {
    const demoMessage = mockEncode("Security demonstration");
    try {
      iframe.contentWindow.postMessage(demoMessage, "https://thebrowser.company");
      console.log("‚ÑπÔ∏è Simulated encoded message sent");
    } catch (e) {
      console.warn("‚ö†Ô∏è PostMessage restriction:", e);
    }
  }, 1000);

  // 3. Structured payload examples
  payloads.forEach((p, i) => {
    setTimeout(() => {
      try {
        iframe.contentWindow.postMessage(p, "https://thebrowser.company");
        console.log(`‚ÑπÔ∏è Demo vector ${i + 1} sent`);
      } catch (e) {
        console.warn(`‚ö†Ô∏è Vector ${i + 1} blocked:`, e);
      }
    }, 1500 + i * 1000);
  });
}

// Start demonstration when iframe loads
iframe.onload = () => {
  console.log("‚úÖ iframe loaded");
  demonstrateVectors();
};

// Error handling
iframe.onerror = () => {
  console.error("‚ùå Failed to load iframe");
};
</script>

</body>
</html>
